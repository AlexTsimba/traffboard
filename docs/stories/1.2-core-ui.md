# Story 1.2: Core Application Shell & UI Integration

## User Story
As a **user**,
I want to **experience a consistent and customizable application layout with integrated UI components and navigation**,
so that **every page and component is developed within the correct visual framework from the start.**

## Status
Draft

## Epic
Epic 1: Foundation, Core UI, & Cohort Report (MVP)

## Acceptance Criteria
1. The application displays a persistent Shadcn sidebar on all protected routes, containing navigation links to reports and a `NavUser` component that includes links for user settings and additional links for admin functions.
2. The application displays a sticky Shadcn header on all protected routes.
3. The header displays breadcrumbs for navigation context.
4. The header dynamically renders a filter button (via a portal) when a report page is active.
5. Theming (dark/light/system mode) is implemented and functional, with system as default.
6. Content layout preference (centered/full-width) is implemented and functional.
7. A centralized `sonner` toast notification system is integrated and displays a test message in the left-bottom corner.
8. The UI adheres to the aesthetic guidelines of Vercel and Notion, and uses Geist font.
9. All core layout components (sidebar, header, main content area) are responsive and functional across supported browsers.

## Tasks / Subtasks
- [ ] Implement persistent Shadcn sidebar on protected routes (AC: 1)
  - [ ] Create sidebar component [Source: architecture.md#Component Organization]
  - [ ] Add navigation links for reports [Source: prd.md#Key Interaction Paradigms]
  - [ ] Integrate `NavUser` component with user settings and admin links [Source: prd.md#Key Interaction Paradigms]
- [ ] Implement sticky Shadcn header on protected routes (AC: 2)
  - [ ] Create header component [Source: architecture.md#Component Organization]
  - [ ] Ensure header remains visible on scroll
- [ ] Implement breadcrumbs in header (AC: 3)
  - [ ] Develop breadcrumb logic based on current route [Source: prd.md#Key Interaction Paradigms]
  - [ ] Display breadcrumbs in header [Source: prd.md#Key Interaction Paradigms]
- [ ] Implement dynamic filter button in header via portal (AC: 4)
  - [ ] Create filter button component [Source: prd.md#Key Interaction Paradigms]
  - [ ] Use React Portal to render button dynamically when report page is active [Source: prd.md#Key Interaction Paradigms]
- [ ] Implement theming (dark/light/system mode) (AC: 5)
  - [ ] Configure theme provider [Source: prd.md#User-Configurable Theming]
  - [ ] Implement theme switching logic [Source: prd.md#User-Configurable Theming]
  - [ ] Set system mode as default [Source: prd.md#User-Configurable Theming]
- [ ] Implement content layout preference (centered/full-width) (AC: 6)
  - [ ] Create layout context/provider [Source: prd.md#Content Layout Preference]
  - [ ] Implement logic to switch between centered and full-width layouts [Source: prd.md#Content Layout Preference]
- [ ] Integrate centralized `sonner` toast notification system (AC: 7)
  - [ ] Install `sonner` library [Source: prd.md#Centralized Toast Notifications]
  - [ ] Configure toast provider [Source: prd.md#Centralized Toast Notifications]
  - [ ] Display a test message in the left-bottom corner [Source: prd.md#Centralized Toast Notifications]
- [ ] Ensure UI adheres to Vercel/Notion aesthetics and uses Geist font (AC: 8)
  - [ ] Apply Geist font to the application [Source: prd.md#Branding]
  - [ ] Review UI components for aesthetic alignment [Source: prd.md#Branding]
- [ ] Ensure core layout components are responsive and functional (AC: 9)
  - [ ] Test sidebar, header, and main content area responsiveness across devices [Source: prd.md#Target Device and Platforms]
  - [ ] Verify functionality in supported browsers [Source: prd.md#Target Device and Platforms]

## Dev Notes
Populate relevant information, only what was pulled from actual artifacts from docs folder, relevant to this story:
- Do not invent information
- If known add Relevant Source Tree info that relates to this story
- If there were important notes from previous story that are relevant to this one, include them here
- Put enough information in this section so that the dev agent should NEVER need to read the architecture documents, these notes along with the tasks and subtasks must give the Dev Agent the complete context it needs to comprehend with the least amount of overhead the information to complete the story, meeting all AC and completing all tasks+subtasks

### Technical Details
- **UI Library:** Shadcn UI [Source: architecture.md#UI Component Library]
- **Font:** Geist [Source: prd.md#Branding]
- **Theming:** Dark/Light/System modes [Source: prd.md#User-Configurable Theming]
- **Notifications:** Sonner toast system [Source: prd.md#Centralized Toast Notifications]
- **Design inspiration:** Vercel and Notion aesthetics [Source: prd.md#Branding]

### Testing
List Relevant Testing Standards from Architecture the Developer needs to conform to:
- Test file location: `apps/web/tests/` for frontend. [Source: architecture.md#Test Organization]
- Test standards: Follow testing pyramid approach (unit, integration, E2E). [Source: architecture.md#Testing Pyramid]
- Testing frameworks and patterns to use: Jest for unit/integration, Playwright for E2E. [Source: architecture.md#Testing Requirements]
- Any specific testing requirements for this story: Ensure all UI components are responsive, themes switch correctly, and notifications display.

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-07-19 | 1.0 | Initial draft with tasks and new sections | Bob (SM) |

## Dev Agent Record
This section is populated by the development agent during implementation

### Agent Model Used
{{agent_model_name_version}}

### Debug Log References

### Completion Notes List

### File List

## QA Results
Results from QA Agent QA review of the completed story implementation

## Definition of Done
- [ ] All acceptance criteria completed
- [ ] Code reviewed
- [ ] Tests passing
- [ ] UI components responsive
- [ ] Accessibility verified